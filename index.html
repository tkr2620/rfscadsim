<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAD Simulator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="container">
        <div class="resources-grid" id="bingoGrid">
            <h3>All Resources</h3>
            <div class="bingo-items-container">
            <div class="bingo-item" id="LGARALU2">LGARALU2</div>
            <div class="bingo-item" id="LGARALU7">LGARALU7</div>
            <div class="bingo-item" id="LGARALU9">LGARALU9</div>
            <div class="bingo-item" id="LGB31">LGB31</div>
            <div class="bingo-item" id="LGB32">LGB32</div>
            <div class="bingo-item" id="LGBOMBA1">LGBOMBA1</div>
            <div class="bingo-item" id="LGBOMBA7">LGBOMBA7</div>
            <div class="bingo-item" id="LGBRAID1">LGBRAID1</div>
            <div class="bingo-item" id="LGBRAID7">LGBRAID7</div>
            <div class="bingo-item" id="LGBRAID9">LGBRAID9</div>
            <div class="bingo-item" id="LGBORMT1">LGBORMT1</div>
            <div class="bingo-item" id="LGBORMT7">LGBORMT7</div>
            <div class="bingo-item" id="LGBUNGEP">LGBUNGEP</div>
            <div class="bingo-item" id="LGBUNGE1">LGBUNGE1</div>
            <div class="bingo-item" id="LGBUNGE7">LGBUNGE7</div>
            <div class="bingo-item" id="LGBUSA">LGBUSA</div>
            <div class="bingo-item" id="LGBUSB">LGBUSB</div>
            <div class="bingo-item" id="LGBUSC">LGBUSC</div>
            <div class="bingo-item" id="LGCAPFL1">LGCAPFL1</div>
            <div class="bingo-item" id="LGCAPFL7">LGCAPFL7</div>
            <div class="bingo-item" id="LGCAPFL9">LGCAPFL9</div>
            <div class="bingo-item" id="LGCARWO1">LGCARWO1</div>
            <div class="bingo-item" id="LGCARWO7A">LGCARWO7A</div>
            <div class="bingo-item" id="LGCARWO7B">LGCARWO7B</div>
            <div class="bingo-item" id="LGCHARL2">LGCHARL2</div>
            <div class="bingo-item" id="LGCHARL7">LGCHARL7</div>
            <div class="bingo-item" id="LGCMDJ">LGCMDJ</div>
            <div class="bingo-item" id="LGCMDK">LGCMDK</div>
            <div class="bingo-item" id="LGLAKEGE1">LGLAKEGE1</div>
            <div class="bingo-item" id="LGLAKEGE6">LGLAKEGE6</div>
            <div class="bingo-item" id="LGDO">LGDO</div>
            <div class="bingo-item" id="LGFARRI1">LGFARRI1</div>
            <div class="bingo-item" id="LGFARRI7">LGFARRI7</div>
            <div class="bingo-item" id="LGFCO1">LGFCO1</div>
            <div class="bingo-item" id="LGFCO2">LGFCO2</div>
            <div class="bingo-item" id="LGFCO41">LGFCO41</div>
            <div class="bingo-item" id="LGFCO42">LGFCO42</div>
            <div class="bingo-item" id="LGFCO43">LGFCO43</div>
            <div class="bingo-item" id="LGFCO51">LGFCO51</div>
            <div class="bingo-item" id="LGG1">LGG1</div>
            <div class="bingo-item" id="LGG2">LGG2</div>
            <div class="bingo-item" id="LGG3">LGG3</div>
            <div class="bingo-item" id="LGG4">LGG4</div>
            <div class="bingo-item" id="LGG5">LGG5</div>
            <div class="bingo-item" id="LGDG1">LGDG1</div>
            <div class="bingo-item" id="LGDG2">LGDG2</div>
            <div class="bingo-item" id="LGDG3">LGDG3</div>
            <div class="bingo-item" id="LGDG4">LGDG4</div>
            <div class="bingo-item" id="LGHOSKI1">LGHOSKI1</div>
            <div class="bingo-item" id="LGHOSKI7">LGHOSKI7</div>
            <div class="bingo-item" id="LGHOSKI9">LGHOSKI9</div>
            <div class="bingo-item" id="LGJERCR1">LGJERCR1</div>
            <div class="bingo-item" id="LGJERCR7A">LGJERCR7A</div>
            <div class="bingo-item" id="LGJERCR9">LGJERCR9</div>
            <div class="bingo-item" id="LGJERCRP">LGJERCRP</div>
            <div class="bingo-item" id="LGKRAWA1">LGKRAWA1</div>
            <div class="bingo-item" id="LGKRAWA7">LGKRAWA7</div>
            <div class="bingo-item" id="LGKRAWA9">LGKRAWA9</div>
            <div class="bingo-item" id="LGLOGISA">LGLOGISA</div>
            <div class="bingo-item" id="LGLOGISB">LGLOGISB</div>
            <div class="bingo-item" id="LGLOGISC">LGLOGISC</div>
            <div class="bingo-item" id="LGLOGISD">LGLOGISD</div>
            <div class="bingo-item" id="LGMAJCR2">LGMAJCR2</div>
            <div class="bingo-item" id="LGMAJCR7">LGMAJCR7</div>
            <div class="bingo-item" id="LGMONGA1">LGMONGA1</div>
            <div class="bingo-item" id="LGMONGA7">LGMONGA7</div>
            <div class="bingo-item" id="LGMULLO1">LGMULLO1</div>
            <div class="bingo-item" id="LGMULLO7">LGMULLO7</div>
            <div class="bingo-item" id="LGNERRI1">LGNERRI1</div>
            <div class="bingo-item" id="LGNERRI7">LGNERRI7</div>
            <div class="bingo-item" id="LGNERRI9">LGNERRI9</div>
            <div class="bingo-item" id="LGOCV">LGOCV</div>
            <div class="bingo-item" id="LGQUEAN1">LGQUEAN1</div>
            <div class="bingo-item" id="LGQUEAN7A">LGQUEAN7A</div>
            <div class="bingo-item" id="LGQUEAN7B">LGQUEAN7B</div>
            <div class="bingo-item" id="LGQUEAN9">LGQUEAN9</div>
            <div class="bingo-item" id="LGRIDGE1A">LGRIDGE1A</div>
            <div class="bingo-item" id="LGRIDGE1B">LGRIDGE1B</div>
            <div class="bingo-item" id="LGWAMBO1A">LGWAMBO1A</div>
            <div class="bingo-item" id="LGWAMBO1B">LGWAMBO1B</div>
            <div class="bingo-item" id="LGWAMBO7A">LGWAMBO7A</div>
            <div class="bingo-item" id="LGWAMBO7B">LGWAMBO7B</div>
        </div>
    </div>
        
    <!-- Log and How-To Column -->
    <div class="log-how-to-column">
        <!-- Log Section (Top Half) -->
        <div class="log-section">
            <h3>Log</h3>
            <div id="log"></div>
        </div>

        <!-- How-To Guide Section (Bottom Half) -->
        <div class="how-to-section">
            <h3>How-To Guide</h3>
            <p>This section will contain instructions on how to use the system:</p>
            <ul>
                <li><code>callsign/s/status</code>: Update a unitâ€™s status.</li>
                <li><code>callsign/m/message</code>: Add an operator comment to a unit.</li>
                <li><code>callsign/m/message;R</code>: Adds a sitrep to the unit under their incident.</li>
            </ul>
        </div>
    </div>
        <div class="incidents-pane">
            <h3>Incidents</h3>
            <div class="incidents-grid" id="incidentsGrid">
                <!-- Example Incident Card -->
                <div class="incident-card" id="47657">
                    <h4>CAD #47657</h4>
                    <p><strong>Type:</strong> GRASS FIRE</p>
                    <p><strong>Address:</strong> 123 Lake Road, Lake George</p>
                    <p><strong>Narrative:</strong> INFT TRAVELLING DOWN FEDERAL HWY SAW SMOKE IN VIC OF GIVEN ADDRESS</p>

                </div>
        
                <div class="incident-card" id="67890">
                    <h4>CAD #67890</h4>
                    <p><strong>Type:</strong> ASSIST AMBOS</p>
                    <p><strong>Address:</strong> 45 Riverside Drive, Braidwood</p>
                    <p><strong>Narrative:</strong> AMBOS REQ URGENT LIFT</p>

                </div>
            </div>
        </div>
        
        <div class="command-section">
            <input type="text" id="commandInput" placeholder="Enter command here.. " autofocus>
            <button onclick="processCommand()">Submit</button>
        </div>
    </div>

    <script>
        window.onload = () => {
            const resources = document.querySelectorAll('.bingo-item');
            resources.forEach(item => item.style.backgroundColor = 'grey');
        };

        function processCommand() {
    const commandInput = document.getElementById("commandInput");
    const log = document.getElementById("log");
    const commandText = commandInput.value.trim();

    if (commandText !== "") {
        const parsedCommands = interpretCommand(commandText);

        parsedCommands.forEach(logMessage => {
            const logEntry = document.createElement("div");
            logEntry.innerHTML = ` ${highlightUnits(logMessage)}`; // Highlight units in the log
            log.prepend(logEntry); // Add new logs to the top
        });

        commandInput.value = "";
    }
}

function highlightUnits(logMessage) {
    // Regex to find unit identifiers that start with "LG"
    const unitRegex = /\b(LG[A-Z0-9]*)\b/g;
    return logMessage.replace(
        unitRegex,
        '<span class="highlight-unit">$1</span>'
    );
}

function getCurrentTime() {
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    return `${hours}:${minutes}:${seconds}`;
}

function interpretCommand(command) {
    const [callsignsPart, commandType, statusOrMessage] = command.split('/');
    const callsigns = callsignsPart.split(',');
    const logMessages = [];

    if (commandType === 'S') {
        const statusString = getStatusString(statusOrMessage);
        callsigns.forEach(callsign => {
            updateResourceStatus(callsign.trim(), statusOrMessage);
            logMessages.push(`
                <div class="log-message">
                    <div class="log-header">
                        <span class="log-tag">STATUS</span>
                        <span class="timestamp">${getCurrentTime()}</span>
                    </div>
                    <span>${callsign.trim()}: Status updated to ${statusString}</span>
                </div>
            `);
        });
    }

    if (commandType === 'M') {
        const messageParts = statusOrMessage.split(';');
        const message = messageParts[0].trim();
        const tag = messageParts[1] === 'R' ? 'SITREP' : 'OPERATOR COMMENT';

        callsigns.forEach(callsign => {
            const logEntryHTML = `
                <div class="log-message">
                    <div class="log-header">
                        <span class="log-tag ${tag.replace(' ', '-')}">${tag}</span>
                        <span class="timestamp">${getCurrentTime()}</span>
                    </div>
                    <span>${callsign.trim()}: ${message}</span>
                </div>
            `;
            logMessages.push(logEntryHTML);
        });
    }

    return logMessages;
}

        function getStatusString(status) {
            const statusMap = {
                '01': 'responding',
                '03': 'on scene',
                '04': 'available',
                '05': 'at station',
                '07': 'not available',
                'AL': 'alerted'
            };
            return statusMap[status] || 'unknown';
        }

        function updateResourceStatus(callsign, status) {
            const resourceElement = document.getElementById(callsign);
            if (!resourceElement) return;

            const statusColors = {
                '01': 'yellow',
                '03': 'black',
                '04': 'green',
                '05': 'grey',
                '07': '#CF9FFF',
                'AL': 'blue'
            };

            resourceElement.style.backgroundColor = statusColors[status] || 'grey';
            resourceElement.style.color = status === '03' ? 'white' : 'black';
        }
    </script>

</body>
</html>
